ğŸ“¦ MÃ“DULO: AUTH
Rama: compras/cristofer

Este mÃ³dulo gestiona la autenticaciÃ³n de usuarios. Permite validar credenciales y generar tokens de acceso seguros mediante JWT.

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ”¹ AUTH
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ğŸ“Œ BASE URL:
http://localhost:3000/api/trans/services

ğŸ“ FUNCIONALIDAD:
- Validar credenciales de usuario
- Generar token JWT para sesiones autenticadas
- Proteger rutas privadas mediante validaciÃ³n de token

ğŸ“ ENDPOINTS:

1. ğŸ”‘ Login
POST /login  
Body:
{
  "username": "admin",
  "password": "admin123"
}

ğŸ”“ Ruta pÃºblica  
ğŸ§  Valida formato de username y password  
ğŸ” Verifica existencia del usuario y contraseÃ±a vÃ¡lida  
âœ… Genera token JWT si las credenciales son correctas  
ğŸ“Œ Devuelve:
```json
{
  "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6...",
  "user": {
    "id": 1,
    "username": "admin",
    "rol": "SuperUser"
  }
}


ğŸ“¦ MÃ“DULOS: PROVIDERS, PROVIDER_INVOICES Y PROVIDER_CONTACTS
Rama: compras/cristofer

Este mÃ³dulo gestiona proveedores, sus facturas y contactos asociados. Incluye creaciÃ³n, ediciÃ³n, eliminaciÃ³n lÃ³gica (soft delete), restauraciÃ³n, bÃºsqueda y validaciÃ³n.

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ”¹ PROVIDERS
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ğŸ“Œ BASE URL:
http://localhost:3000/api/trans/services

ğŸ“ FUNCIONALIDAD:
- Crear, listar, actualizar y eliminar proveedores
- Restaurar proveedores eliminados
- Buscar proveedores por nombre
- Validar duplicados por RIF

ğŸ“ ENDPOINTS:

1. â• Crear proveedor
POST /provider
Body:
{
  "name": "Distribuidora Lara",
  "rif": "J-11223344-5",
  "balance": 18000
}

2. ğŸ“„ Listar proveedores activos
GET /providers

3. ğŸ” Buscar proveedor por nombre
GET /provider/search/:name
Ejemplo: /provider/search/Lara

4. âœï¸ Actualizar proveedor
PATCH /provider/:id
Body:
{
  "name": "Distribuidora Lara Actualizada",
  "rif": "J-11223344-5",
  "balance": 20000
}

5. ğŸ—‘ï¸ Eliminar proveedor (soft delete)
DELETE /provider/:id

6. â™»ï¸ Restaurar proveedor eliminado
PUT /provider/restore/:id
Body:
{
  "rif": "J-11223344-5"
}

7. ğŸ‘» Listar proveedores eliminados
GET /providers-deleted

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ”¹ PROVIDER_INVOICES
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ğŸ“ FUNCIONALIDAD:
- Crear, listar, buscar, eliminar y restaurar facturas de proveedores
- ValidaciÃ³n de formato para campos como control_number, invoice_number, fechas y montos
- Soft delete con renombrado automÃ¡tico del control_number
- RestauraciÃ³n con validaciÃ³n de duplicados

ğŸ“ ENDPOINTS:

1. â• Crear factura
POST /provider-invoice/:provider_id
Body:
{
  "control_number": "CN-0001",
  "invoice_number": "INV-0001",
  "invoice_date": "2025-11-03",
  "total_amount": 1200
}

2. ğŸ“„ Listar todas las facturas activas
GET /provider-invoices

3. ğŸ“„ Listar facturas por proveedor
GET /provider-invoices/:provider_id

4. ğŸ” Buscar por nÃºmero fiscal o control
GET /provider-invoices/search/:term
Ejemplo: /provider-invoices/search/INV

5. ğŸ“… Filtrar por rango de fechas
GET /provider-invoices-range?start=YYYY-MM-DD&end=YYYY-MM-DD
Ejemplo: /provider-invoices-range?start=2025-11-01&end=2025-11-30

6. ğŸ—‘ï¸ Eliminar factura (soft delete)
DELETE /provider-invoice/:id

7. ğŸ‘» Listar facturas eliminadas
GET /provider-invoices-deleted

8. â™»ï¸ Restaurar factura eliminada
PUT /provider-invoice/restore/:id
Body:
{
  "control_number": "CN-0001-R"
}

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ”¹ PROVIDER_CONTACTS
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ğŸ“ FUNCIONALIDAD:
- Crear y eliminar contactos asociados a proveedores
- ValidaciÃ³n de formato (email o nÃºmero)
- Evita duplicados por proveedor
- Listado por proveedor

ğŸ“ ENDPOINTS:

1. â• Crear contacto
POST /provider-contact/:provider_id
Body:
{
  "contact_info": "04141234567"
}
// TambiÃ©n acepta correos: "contact_info": "correo@ejemplo.com"

2. ğŸ—‘ï¸ Eliminar contacto
DELETE /provider-contact/:contact_id

3. ğŸ“„ Listar contactos por proveedor
GET /provider-contact/:provider_id

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ” HEADERS REQUERIDOS PARA TODOS LOS ENDPOINTS:

Authorization: Bearer <tu_token>
Content-Type: application/json

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ§ª VALIDACIONES DESTACADAS:

- RIF: formato tipo J-12345678-9
- control_number y invoice_number: sin caracteres especiales no permitidos
- balance y total_amount: deben ser numÃ©ricos positivos
- invoice_date: formato YYYY-MM-DD
- contact_info: debe ser nÃºmero vÃ¡lido o email vÃ¡lido

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ§  NOTAS:

- Las eliminaciones son lÃ³gicas (soft delete), no se pierde la data.
- Al eliminar una factura, su control_number se renombra como "deleted_<timestamp>".
- Al restaurar, se valida que el nuevo control_number no estÃ© duplicado.
- Al restaurar un proveedor, se valida que su RIF no estÃ© duplicado entre los activos.
- Los contactos se validan por formato y se evita duplicaciÃ³n por proveedor.

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“¦ MÃ“DULO: USERS
Rama: compras/cristofer

Este mÃ³dulo gestiona usuarios del sistema. Incluye creaciÃ³n, ediciÃ³n, eliminaciÃ³n, consulta y validaciÃ³n. EstÃ¡ protegido por token y roles.

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ”¹ USERS
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ğŸ“Œ BASE URL:
http://localhost:3000/api/trans/services

ğŸ“ FUNCIONALIDAD:
- Crear, listar, buscar, actualizar y eliminar usuarios
- Validar duplicados por username
- Evitar que un usuario se elimine o actualice a sÃ­ mismo
- Validar formato de campos (username, password, rol)
- Encriptar contraseÃ±as con bcrypt

ğŸ“ ENDPOINTS:

1. â• Crear usuario
POST /users  
Body:
{
  "username": "admin",
  "password": "admin123",
  "rol": "SuperUser"
}

ğŸ”’ Requiere token y rol: SuperUser  
ğŸ” La contraseÃ±a se encripta automÃ¡ticamente con bcrypt

2. ğŸ“„ Listar todos los usuarios (excepto el que hace la peticiÃ³n)
GET /users

ğŸ”’ Requiere token y rol: SuperUser  
ğŸ§  Excluye al usuario autenticado (`req.user.id`)

3. ğŸ” Buscar usuario por ID
GET /users/:id  
Ejemplo: /users/5

ğŸ”’ Requiere token y rol: SuperUser

4. âœï¸ Actualizar usuario
PATCH /users/:id  
Body:
{
  "username": "admin_actualizado",
  "rol": "Administrador"
}

ğŸ”’ Requiere token y rol: SuperUser  
â— No se permite que un usuario se actualice a sÃ­ mismo  
ğŸ§  Valida duplicado de username

5. ğŸ—‘ï¸ Eliminar usuario
DELETE /users/:id

ğŸ”’ Requiere token y rol: SuperUser  
â— No se permite que un usuario se elimine a sÃ­ mismo

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ” HEADERS REQUERIDOS PARA TODOS LOS ENDPOINTS:

Authorization: Bearer <tu_token>  
Content-Type: application/json

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ§ª VALIDACIONES DESTACADAS:

- username: solo letras, nÃºmeros y espacios
- password: texto vÃ¡lido (sin caracteres especiales invÃ¡lidos)
- rol: solo letras y espacios
- id: debe ser numÃ©rico

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ§  LÃ“GICA DE NEGOCIO (Service Layer):

- ğŸ” ContraseÃ±as encriptadas con bcrypt (10 salt rounds)
- âŒ No se permite crear ni actualizar usuarios con username duplicado
- âŒ No se permite eliminar ni actualizar al usuario autenticado
- âœ… ValidaciÃ³n de existencia previa del usuario antes de eliminar o actualizar
- âœ… Middleware de validaciÃ³n para cada operaciÃ³n (crear, actualizar, eliminar)

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“¦ MÃ“DULO: PAYROLLS
Rama: compras/cristofer

Este mÃ³dulo gestiona las nÃ³minas del personal. Permite registrar, consultar, actualizar y cambiar el estado de las nÃ³minas. Incluye validaciones de fechas, montos, solapamientos y estado.

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ”¹ PAYROLLS
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ğŸ“Œ BASE URL:
http://localhost:3000/api/trans/services

ğŸ“ FUNCIONALIDAD:
- Crear nÃ³minas para empleados
- Consultar nÃ³minas por mes y aÃ±o
- Actualizar datos de una nÃ³mina
- Cambiar el estado de una nÃ³mina (draft, paid, cancelled)
- Validar fechas, montos, solapamientos y estados
- Calcular salario neto con bonificaciones y deducciones
- Asociar nÃ³minas con empleados

ğŸ“ ENDPOINTS:

1. â• Crear nÃ³mina
POST /payrolls  
Body:
{
  "employee_id": 1,
  "base_salary": 1000,
  "period_start": "2025-11-01",
  "period_end": "2025-11-15",
  "payment_date": "2025-11-16",
  "hours_worked": 80,
  "bonus": 100,
  "deductions": 50
}

ğŸ”’ Requiere token y rol: Administrador o SuperUser  
ğŸ§  Valida existencia del empleado y solapamiento de fechas  
ğŸ§® Calcula salario neto con bonificaciones y deducciones

2. ğŸ“„ Consultar nÃ³minas por mes y aÃ±o
GET /payrolls/search  
Query o body:
{
  "year": 2025,
  "month": 11
}

ğŸ”’ Requiere token y rol: Administrador o SuperUser  
ğŸ§  Permite enviar filtros por query o body (`filterSearch`)  
ğŸ“† Ajusta fechas automÃ¡ticamente para cubrir el mes o aÃ±o completo

3. âœï¸ Actualizar nÃ³mina
PUT /payrolls/:id  
Body:
{
  "employee_id": 1,
  "base_salary": 1100,
  "period_start": "2025-11-01",
  "period_end": "2025-11-15",
  "payment_date": "2025-11-16",
  "hours_worked": 85,
  "bonus": 150,
  "deductions": 30
}

ğŸ”’ Requiere token y rol: Administrador o SuperUser  
ğŸ§  Solo permite modificar nÃ³minas en estado `draft`  
âŒ Valida que no haya solapamiento con otras nÃ³minas del mismo empleado  
ğŸ§® Recalcula salario neto

4. ğŸ”„ Cambiar estado de nÃ³mina
PATCH /payrolls/:id/:status  
Ejemplo: /payrolls/3/paid

ğŸ”’ Requiere token y rol: Administrador o SuperUser  
ğŸ§  Solo permite cambiar estado si la nÃ³mina estÃ¡ en `draft`  
ğŸ¯ Estados vÃ¡lidos: `draft`, `paid`, `cancelled`

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ” HEADERS REQUERIDOS PARA TODOS LOS ENDPOINTS:

Authorization: Bearer <tu_token>  
Content-Type: application/json

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ§ª VALIDACIONES DESTACADAS:

- employee_id, hours_worked: deben ser numÃ©ricos
- base_salary, bonus, deductions: deben ser montos vÃ¡lidos
- period_start, period_end, payment_date: deben ser fechas vÃ¡lidas
- status: solo acepta "draft", "paid", "cancelled"
- year: debe tener 4 dÃ­gitos y no ser mayor al aÃ±o actual
- month: debe estar entre 1 y 12

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ§  LÃ“GICA DE NEGOCIO (Service Layer):

- âŒ No se permite modificar una nÃ³mina si ya estÃ¡ cerrada (`paid` o `cancelled`)
- âŒ No se permite crear o actualizar una nÃ³mina si se solapa con otra del mismo empleado
- âœ… Se valida que el empleado exista antes de crear o actualizar
- âœ… Se permite enviar filtros por query o body para consultar nÃ³minas
- âœ… Se incluye informaciÃ³n del empleado (nombre y cÃ©dula) en la respuesta
- âœ… Se calcula el salario neto con bonificaciones y deducciones usando `isrCalculator`

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“¦ MÃ“DULO: USERS
Rama: compras/cristofer

Este mÃ³dulo gestiona usuarios del sistema. Permite crear, consultar, actualizar y eliminar usuarios, con validaciones de formato, control de duplicados y protecciÃ³n contra acciones sobre uno mismo.

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ”¹ USERS
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ğŸ“Œ BASE URL:
http://localhost:3000/api/trans/services

ğŸ“ FUNCIONALIDAD:
- Crear usuarios con contraseÃ±a encriptada
- Listar todos los usuarios (excepto el que hace la peticiÃ³n)
- Buscar usuario por ID
- Actualizar username o rol
- Eliminar usuarios
- Validar duplicados por username
- Evitar que un usuario se elimine o actualice a sÃ­ mismo

ğŸ“ ENDPOINTS:

1. â• Crear usuario
POST /users  
Body:
{
  "username": "admin",
  "password": "admin123",
  "rol": "SuperUser"
}

ğŸ”’ Requiere token y rol: SuperUser  
ğŸ” La contraseÃ±a se encripta automÃ¡ticamente con bcrypt  
âŒ Valida que el username no exista

2. ğŸ“„ Listar todos los usuarios (excepto el que hace la peticiÃ³n)
GET /users

ğŸ”’ Requiere token y rol: SuperUser  
ğŸ§  Excluye al usuario autenticado (`req.user.id`)

3. ğŸ” Buscar usuario por ID
GET /users/:id  
Ejemplo: /users/5

ğŸ”’ Requiere token y rol: SuperUser  
âŒ Devuelve error si el usuario no existe

4. âœï¸ Actualizar usuario
PATCH /users/:id  
Body:
{
  "username": "admin_actualizado",
  "rol": "Administrador"
}

ğŸ”’ Requiere token y rol: SuperUser  
âŒ No se permite que un usuario se actualice a sÃ­ mismo  
âŒ Valida duplicado de username

5. ğŸ—‘ï¸ Eliminar usuario
DELETE /users/:id

ğŸ”’ Requiere token y rol: SuperUser  
âŒ No se permite que un usuario se elimine a sÃ­ mismo  
âŒ Devuelve error si el usuario no existe

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ” HEADERS REQUERIDOS PARA TODOS LOS ENDPOINTS:

Authorization: Bearer <tu_token>  
Content-Type: application/json

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ§ª VALIDACIONES DESTACADAS (middlewares):

- username: solo letras, nÃºmeros y espacios
- password: texto vÃ¡lido (sin caracteres especiales invÃ¡lidos)
- rol: solo letras y espacios
- id: debe ser numÃ©rico
- username y rol son opcionales en update, pero al menos uno debe estar presente

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ§  LÃ“GICA DE NEGOCIO (Service Layer):

- ğŸ” ContraseÃ±as encriptadas con bcrypt (10 salt rounds)
- âŒ No se permite crear ni actualizar usuarios con username duplicado
- âŒ No se permite eliminar ni actualizar al usuario autenticado
- âœ… ValidaciÃ³n de existencia previa del usuario antes de eliminar o actualizar
- âœ… Middleware de validaciÃ³n para cada operaciÃ³n (crear, actualizar, eliminar)
- âœ… Respuestas estandarizadas con cÃ³digos y mensajes claros

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“¦ MÃ“DULO: EMPLOYEE
Rama: compras/cristofer

Este mÃ³dulo gestiona empleados del sistema. Permite crear, consultar, actualizar, eliminar y restaurar empleados, con validaciones de formato, control de duplicados y protecciÃ³n contra acciones sobre uno mismo.

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ”¹ EMPLOYEE
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ğŸ“Œ BASE URL:
http://localhost:3000/api/trans/services

ğŸ“ FUNCIONALIDAD:
- Crear empleados con mÃºltiples contactos
- Consultar empleados activos/inactivos por nombre o cÃ©dula
- Actualizar datos del empleado
- Eliminar empleados (soft delete)
- Restaurar empleados eliminados
- Validar duplicados por cÃ©dula y contactos
- Excluir al usuario autenticado en consultas

ğŸ“ ENDPOINTS:

1. â• Crear empleado
POST /employee  
Body:
{
  "name": "Carlos",
  "lastname": "PÃ©rez",
  "ci": "V-12345678",
  "rol": "Operador",
  "contacts": [
    { "contact_info": "04141234567" },
    { "contact_info": "correo@ejemplo.com" }
  ]
}

ğŸ”’ Requiere token y rol: Administrador o SuperUser  
ğŸ§  Valida formato de nombre, apellido, cÃ©dula, rol y contactos  
âŒ Verifica duplicado de cÃ©dula y contactos  
ğŸ” Usa transacciÃ³n para crear empleado y contactos juntos

2. ğŸ“„ Consultar empleados por estado y filtro
GET /employee/search/:active/:filter  
Ejemplos:
- /employee/search/true/all â†’ todos los activos
- /employee/search/false/all â†’ todos los inactivos
- /employee/search/true/Carlos â†’ bÃºsqueda por nombre
- /employee/search/true/V-12345678 â†’ bÃºsqueda por cÃ©dula

ğŸ”’ Requiere token y rol: Administrador o SuperUser  
ğŸ§  Filtra por estado (`is_active`) y por nombre o cÃ©dula  
âŒ Excluye al usuario autenticado (`req.user.id`)

3. âœï¸ Actualizar empleado
PATCH /employee/:id  
Body:
{
  "name": "Carlos Actualizado",
  "lastname": "PÃ©rez",
  "ci": "V-87654321",
  "rol": "Supervisor"
}

ğŸ”’ Requiere token y rol: Administrador o SuperUser  
âŒ No se permite que un usuario se actualice a sÃ­ mismo  
âŒ Valida duplicado de cÃ©dula  
ğŸ§  Valida existencia del empleado

4. ğŸ—‘ï¸ Eliminar empleado
DELETE /employee/:id

ğŸ”’ Requiere token y rol: Administrador o SuperUser  
âŒ No se permite que un usuario se elimine a sÃ­ mismo  
ğŸ§  Valida existencia del empleado  
ğŸ§¹ Soft delete: actualiza `is_active` a false

5. â™»ï¸ Restaurar empleado eliminado
PATCH /employee/restore/:id

ğŸ”’ Requiere token y rol: Administrador o SuperUser  
ğŸ§  Valida existencia del empleado eliminado  
ğŸ” Actualiza `is_active` a true

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ” HEADERS REQUERIDOS PARA TODOS LOS ENDPOINTS:

Authorization: Bearer <tu_token>  
Content-Type: application/json

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ§ª VALIDACIONES DESTACADAS (middlewares):

- name, lastname, rol: solo letras y espacios
- ci: formato vÃ¡lido tipo V-12345678
- contacts: debe contener al menos un email o nÃºmero vÃ¡lido
- id: debe ser numÃ©rico
- En update: al menos un campo debe estar presente

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ§  LÃ“GICA DE NEGOCIO (Service Layer):

- âŒ No se permite eliminar ni actualizar al usuario autenticado
- âŒ No se permite crear empleados con cÃ©dula o contacto duplicado
- âœ… ValidaciÃ³n de existencia previa del empleado antes de eliminar, actualizar o restaurar
- âœ… Middleware de validaciÃ³n para cada operaciÃ³n (crear, actualizar, eliminar, restaurar)
- âœ… Respuestas estandarizadas con cÃ³digos y mensajes claros
- ğŸ” Uso de transacciones para garantizar consistencia entre empleado y contactos

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“¦ MÃ“DULO: EMPLOYEE_CONTACTS
Rama: compras/cristofer

Este mÃ³dulo gestiona los contactos asociados a empleados. Permite crear, actualizar y eliminar contactos, con validaciones de formato y control de duplicados.

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ”¹ EMPLOYEE_CONTACTS
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ğŸ“Œ BASE URL:
http://localhost:3000/api/trans/services

ğŸ“ FUNCIONALIDAD:
- Crear contactos para empleados
- Eliminar contactos por ID
- Actualizar mÃºltiples contactos en lote
- Validar formato de email o nÃºmero telefÃ³nico
- Evitar duplicados de contact_info

ğŸ“ ENDPOINTS:

1. â• Crear contacto
POST /employees/contact/:employee_id  
Body:
{
  "contact_info": "04141234567"
}
// TambiÃ©n acepta correos: "contact_info": "correo@ejemplo.com"

ğŸ”’ Requiere token y rol: Administrador o SuperUser  
ğŸ§  Valida que el contacto no exista y que el empleado sea vÃ¡lido  
ğŸ“Œ Normaliza el contacto (trim + lowercase)

2. ğŸ—‘ï¸ Eliminar contacto
DELETE /employees/contact/:contact_id

ğŸ”’ Requiere token y rol: Administrador o SuperUser  
ğŸ§  Valida que el contacto exista  
ğŸ§¹ Elimina el contacto permanentemente

3. âœï¸ Actualizar mÃºltiples contactos
PATCH /employees/contact  
Body:
{
  "contacts": [
    { "id": 1, "contact_info": "nuevo@correo.com" },
    { "id": 2, "contact_info": "04141234567" }
  ]
}

ğŸ”’ Requiere token y rol: Administrador o SuperUser  
ğŸ§  Valida formato de cada contacto  
ğŸ” Actualiza en transacciÃ³n  
ğŸ“Œ Devuelve contactos actualizados y omitidos

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ” HEADERS REQUERIDOS PARA TODOS LOS ENDPOINTS:

Authorization: Bearer <tu_token>  
Content-Type: application/json

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ§ª VALIDACIONES DESTACADAS (middlewares):

- contact_info: debe ser un nÃºmero vÃ¡lido o un email vÃ¡lido
- id: debe ser numÃ©rico
- En update: se requiere un arreglo de contactos con id y contact_info vÃ¡lidos

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ§  LÃ“GICA DE NEGOCIO (Service Layer):

- âŒ No se permite crear contactos duplicados
- âŒ No se permite actualizar si todos los contact_info ya existen
- âœ… ValidaciÃ³n de existencia del empleado antes de crear
- âœ… ValidaciÃ³n de existencia del contacto antes de eliminar o actualizar
- âœ… NormalizaciÃ³n de datos (trim y lowercase)
- ğŸ” Uso de transacciones para actualizaciones mÃºltiples
- âœ… Respuestas estandarizadas con cÃ³digos y mensajes claros

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“¦ MÃ“DULO: CLIENTS
Rama: compras/cristofer

Este mÃ³dulo gestiona clientes del sistema. Permite crear, consultar y actualizar clientes, con validaciones de formato y control de duplicados por RIF y contacto.

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ”¹ CLIENTS
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ğŸ“Œ BASE URL:
http://localhost:3000/api/trans/services

ğŸ“ FUNCIONALIDAD:
- Crear clientes con RIF, nombre, contacto y direcciÃ³n
- Consultar clientes por nombre o RIF
- Actualizar datos del cliente
- Validar duplicados por RIF y contacto

ğŸ“ ENDPOINTS:

1. â• Crear cliente
POST /clients  
Body:
{
  "rif": "J-12345678-9",
  "name": "Distribuidora Lara",
  "contact": "04141234567",
  "address": "Av. Principal, Barquisimeto"
}

ğŸ”’ Requiere token y rol: Administrador o SuperUser  
ğŸ§  Valida formato de RIF, nombre, contacto y direcciÃ³n  
âŒ Verifica duplicado por RIF y contacto

2. ğŸ“„ Consultar clientes por filtro
GET /clients/:filter  
Ejemplos:
- /clients/all â†’ todos los clientes
- /clients/J-12345678-9 â†’ bÃºsqueda por RIF
- /clients/Lara â†’ bÃºsqueda por nombre

ğŸ”’ Requiere token y rol: Administrador o SuperUser  
ğŸ§  Filtra por RIF exacto o nombre que comienza con el texto

3. âœï¸ Actualizar cliente
PATCH /clients/:id  
Body:
{
  "rif": "J-98765432-1",
  "name": "Distribuidora Lara Actualizada",
  "contact": "04141234567",
  "address": "Av. Nueva, Barquisimeto"
}

ğŸ”’ Requiere token y rol: Administrador o SuperUser  
ğŸ§  Valida existencia del cliente  
âŒ Verifica duplicado por RIF y contacto  
ğŸ“Œ Permite actualizar uno o mÃ¡s campos

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ” HEADERS REQUERIDOS PARA TODOS LOS ENDPOINTS:

Authorization: Bearer <tu_token>  
Content-Type: application/json

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ§ª VALIDACIONES DESTACADAS (middlewares):

- rif: formato tipo J-12345678-9
- name: solo letras y espacios
- contact: debe ser numÃ©rico
- address: debe ser texto vÃ¡lido
- id: debe ser numÃ©rico
- En update: al menos un campo debe estar presente

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ§  LÃ“GICA DE NEGOCIO (Service Layer):

- âŒ No se permite crear ni actualizar clientes con RIF o contacto duplicado
- âœ… ValidaciÃ³n de existencia previa del cliente antes de actualizar
- âœ… Middleware de validaciÃ³n para cada operaciÃ³n (crear, consultar, actualizar)
- âœ… Respuestas estandarizadas con cÃ³digos y mensajes claros

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
