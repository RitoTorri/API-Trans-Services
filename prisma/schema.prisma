generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model users {
  id          Int      @id @default(autoincrement())
  id_employee Int
  user_name   String   @db.VarChar(30)
  password    String   @db.VarChar(60)
  created_at  DateTime @default(now()) @map("created_at")

  employees employees @relation(fields: [id_employee], references: [id], onDelete: Cascade)

  @@map("users")
}

model roles {
  id          Int      @id @default(autoincrement())
  role_name   String   @db.VarChar(30)
  description String   @db.VarChar(100)
  created_at  DateTime @default(now()) @map("created_at")

  employees employees[]

  @@map("roles")
}

model employees {
  id         Int      @id @default(autoincrement())
  name       String   @db.VarChar(40)
  lastname   String   @db.VarChar(40)
  ci         String   @db.VarChar(13) @unique
  role       Int
  active     Boolean  @default(true)
  created_at DateTime @default(now()) @map("created_at")

  roles              roles               @relation(fields: [role], references: [id])
  users              users[]
  contacts_employees contacts_employees[]
  payrolls           payrolls[]
  vehicles           vehicles[]
  @@map("employees")
}

model contacts_employees {
  id           Int      @id @default(autoincrement())
  id_employee  Int
  contact_info String   @db.VarChar(100)
  created_at   DateTime @default(now()) @map("created_at")

  employees employees @relation(fields: [id_employee], references: [id], onDelete: Cascade)

  @@map("contacts_employees")
}

model payrolls {
  id           Int       @id @default(autoincrement())
  id_employee  Int
  base_salary  Decimal   @db.Decimal(10, 2)
  period_start DateTime
  period_end   DateTime
  payment_date DateTime
  created_at   DateTime  @default(now()) @map("created_at")
  updated_at   DateTime?
  active       Boolean   @default(true)

  employees employees @relation(fields: [id_employee], references: [id], onDelete: Cascade)

  @@map("payrolls")
}

model vehicles {
  id                Int      @id @default(autoincrement())
  id_driver         Int
  license_plate     String   @db.VarChar(10)
  total_seats       Int
  id_vehicle_types  Int
  created_at        DateTime @default(now()) @map("created_at")

  employees       employees       @relation(fields: [id_driver], references: [id], onDelete: Cascade)
  vehicles_types  vehicles_types  @relation(fields: [id_vehicle_types], references: [id], onDelete: Cascade)

  @@map("vehicles")
}

model vehicles_types {
  id          Int      @id @default(autoincrement())
  type_name   String   @db.VarChar(20)
  description String   @db.VarChar(100)
  created_at  DateTime @default(now()) @map("created_at")

  vehicles vehicles[]

  @@map("vehicles_types")
}

model clients {
  id         Int      @id @default(autoincrement())
  code       String   @db.VarChar(20)
  name       String   @db.VarChar(30)
  contact    String   @db.VarChar(20)
  address    String   @db.VarChar(100)
  active     Boolean  @default(true)
  created_at DateTime @default(now()) @map("created_at")

  @@map("clients")
}

model invoices_purchase {
  id                    Int       @id @default(autoincrement())
  id_invoice_provider   Int
  id_type_expense       Int
  date_purchase         DateTime
  description           String    @db.Text
  exempt                Decimal   @db.Decimal(10, 2)
  total                 Decimal   @db.Decimal(10, 2)
  created_at            DateTime  @default(now()) @map("created_at")

  invoices_providers invoices_providers @relation(fields: [id_invoice_provider], references: [id], onDelete: Cascade)
  types_expenses     types_expenses     @relation(fields: [id_type_expense], references: [id], onDelete: Cascade)

  @@map("invoices_purchase")
}

model types_expenses {
  id          Int      @id @default(autoincrement())
  name        String   @db.VarChar(30)
  created_at  DateTime @default(now()) @map("created_at")

  invoices_purchase invoices_purchase[]

  @@map("types_expenses")
}

model providers {
  id         Int       @id @default(autoincrement())
  name       String    @db.VarChar(30)
  rif        String    @db.VarChar(30)
  balance    Decimal   @db.Decimal(10, 2)
  active     Boolean   @default(true)
  created_at DateTime  @default(now()) @map("created_at")

  contacts_providers  contacts_providers[]
  invoices_providers  invoices_providers[]

  @@map("providers")
}

model invoices_providers {
  id            Int       @id @default(autoincrement())
  id_provider   Int
  n_control     String    @db.VarChar(30)
  n_invoice     String    @db.VarChar(30)
  date_invoice  DateTime
  total         Decimal   @db.Decimal(10, 2)
  created_at    DateTime  @default(now()) @map("created_at")

  providers               providers               @relation(fields: [id_provider], references: [id], onDelete: Cascade)
  invoices_purchase       invoices_purchase[]
  details_invoice_provider details_invoice_provider[]

  @@map("invoices_providers")
}

model details_invoice_provider {
  id                    Int       @id @default(autoincrement())
  id_invoice_provider   Int
  description           String    @db.Text
  count_items           Int
  unit_price            Decimal   @db.Decimal(10, 2)
  subtotal              Decimal   @db.Decimal(10, 2)
  created_at            DateTime  @default(now()) @map("created_at")

  invoices_providers invoices_providers @relation(fields: [id_invoice_provider], references: [id], onDelete: Cascade)

  @@map("details_invoice_provider")
}

model contacts_providers {
  id           Int      @id @default(autoincrement())
  id_provider  Int
  contact      String   @db.VarChar(100)
  created_at   DateTime @default(now()) @map("created_at")

  providers providers @relation(fields: [id_provider], references: [id], onDelete: Cascade)

  @@map("contacts_providers")
}